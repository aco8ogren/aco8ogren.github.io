<!-- 
/*
* @Author: alex
* @Date: 2025-08-22 15:34:48
 * @Last Modified by: alex
 * @Last Modified time: 2025-10-21 15:39:14
*/
 -->
<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Alex Ogren</title>
  <link rel="stylesheet" href="./style/style.css">
</head>

<body>
  <!-- Template for example text -->
  <template id="repeated-text">
    <div class="copy">
      <div class="text">
        <p>Here are some words that you may want to read.</p>
        <p>You also may not want to read them.</p>
        <p>But by now you've already read them.</p>
        <p style="color:#af2ea9">(<span data-idx></span> out of <span data-total></span>)</p>
      </div>
      <div class="spacer"></div>
    </div>
  </template>

  <!-- Horizontal strip with three pages -->
  <div id="page-strip">

    <!-- ========== PAGE 1 ========== -->
    <section class="page" id="page-1">
      <div class="page-shell">
        <header class="header">
          <div class="center-horizontally">
            <h1>Alex Ogren</h1>
            <nav class="nav-row">
              <a href="https://www.github.com/aco8ogren" target="_blank" rel="noopener noreferrer" class="nav-link">
                <svg class="icon">
                  <use href="#icon-github"></use>
                </svg>
                GitHub
              </a>
              <a href="#page-2" class="nav-link">CV</a>
              <!-- <a href="https://scholar.google.com/citations?user=nCxgagUAAAAJ&hl=en&oi=ao" target="_blank"
                rel="noopener noreferrer" class="nav-link">
                <svg class="icon">
                  <use href="#icon-google-scholar"></use>
                </svg>
                Google Scholar
              </a> -->
              <a href="#page-2" class="nav-link next">next →</a>
            </nav>
          </div>
        </header>


        <div class="page-body scroller edge-fade-x" id="pbs1" data-camera-scroll-source>
          <div class="container" style="display: flex; justify-content: center;">
            <img src="./graphics/rollerblading_new.png" style="width: 88%">
          </div>

          <!-- <p style="text-align: justify">
            I'm a math-minded engineer who enjoys building things - both abstract and real.
            I'm motivated by weaving together concepts from different fields to produce novel, impactful solutions to
            real-world problems.
            On this site you will find information about my talents, projects, education, interests, and more.
          </p> -->
          <p style="text-align: justify">
            I'm a math-minded engineer, motivated by weaving together concepts from different fields to produce novel,
            impactful solutions to
            real-world problems.
            My PhD focused on applying computer vision, machine learning, and inference to elastodynamic problems.
            On this site you will find information about my talents, projects & publications, education, interests, and more.
          </p>
          <div class="spacer"></div>
          <h3>
            Site credits
          </h3>
          <p class="comfy-spacing">
            Scene physics, logic, and artwork hand-rolled by yours truly.<br>
            Photo of me rollerblading taken by Catherine Goohs.<br>
          </p>
          <h4>
            Tools
          </h4>
          <p class="comfy-spacing">
            Inkscape used for creating leaf art.<br>
            Three.js used for scene rendering.<br>
            Apache ECharts used to make plots.<br>
            MathJax used for math typesetting.<br>
          </p>
        </div>
      </div>
    </section>

    <!-- ========== PAGE 2 ========== -->
    <section class="page" id="page-2">
      <div class="page-shell">
        <header class="header">
          <div class="center-horizontally">
            <h1>CV</h1>
            <nav class="nav-row">
              <!-- middle page -->
              <a href="#page-1" class="nav-link prev">← prev</a>
              <a href="#page-3" class="nav-link next">next →</a>
            </nav>
          </div>
        </header>

        <div class="page-body scroller edge-fade-x" id="pbs2" data-camera-scroll-source>
          <div class="resume" id="resume">
            <header class="resume-header">
              <h2>Alex Ogren</h2>
            </header>

            <section>
              <h3>Education</h3>

              <p class="entry">
                <strong class="organization">
                  <span class="only-desktop">California Institute of Technology</span>
                  <span class="only-mobile">Caltech</span>
                </strong>
                <span class="location only-desktop">Pasadena, California</span>
                <span class="location only-mobile">Pasadena, CA</span>
                <span class="position">Ph.D. Mechanical Engineering</span>
                <time datetime="2024-05" class="date-range">May 2024</time>
              </p>

              <p class="entry">
                <strong class="organization">
                  <span class="only-desktop">University of Wisconsin–Madison</span>
                  <span class="only-mobile">UW – Madison</span>
                </strong>
                <span class="location only-desktop">Madison, Wisconsin</span>
                <span class="location only-mobile">Madison, WI</span>
                <!-- <span class="position">BS Engineering Mechanics<span class="only-desktop">; </span><br class="only-mobile">BS Mathematics</span> -->
                <span class="position">B.S. Engineering Mechanics<br>B.S. Mathematics</span>
                <time datetime="2018-05" class="date-range">May 2018</time>
              </p>
            </section>


            <section>

              <h3>Experience</h3>

              <p class="entry">
                <strong class="organization">
                  <span class="only-desktop">California Institute of Technology</span>
                  <span class="only-mobile">Caltech</span>
                </strong>
                <span class="location only-desktop">Pasadena, California</span>
                <span class="location only-mobile">Pasadena, CA</span>
                <span class="position only-desktop">Postdoctoral Scholar</span>
                <span class="position only-mobile">Postdoc</span>
                <span class="date-range">
                  <time datetime="2024-05">May</time> – <time datetime="2024-12">Dec 2024</time>
                </span>
              </p>

              <p class="entry">
                <strong class="organization">
                  <span class="only-desktop">Meta Reality Labs</span>
                  <span class="only-mobile">Meta</span>
                </strong>
                <span class="location only-desktop">Redmond, Washington</span>
                <span class="location only-mobile">Redmond, WA</span>
                <span class="position only-desktop">Research Engineer Intern</span>
                <span class="position only-mobile">Research Intern</span>
                <span class="date-range">
                  <time datetime="2022-05">May</time> – <time datetime="2022-09">Sept 2022</time>
                </span>
              </p>

              <p class="entry">
                <strong class="organization">
                  <span class="only-desktop">ATA Engineering</span>
                  <span class="only-mobile">ATA</span>
                </strong>
                <span class="location only-desktop">San Diego, California</span>
                <span class="location only-mobile">San Diego, CA</span>
                <span class="position only-desktop">Graduate Engineer Intern</span>
                <span class="position only-mobile">Graduate Intern</span>
                <span class="date-range">
                  <time datetime="2018-05">May</time> – <time datetime="2018-09">Sept 2018</time>
                </span>
              </p>

              <p class="entry">
                <strong class="organization">
                  <span class="only-desktop">University of Wisconsin – Madison</span>
                  <span class="only-mobile">UW – Madison</span>
                </strong>
                <span class="location only-desktop">Madison, Wisconsin</span>
                <span class="location only-mobile">Madison, WI</span>
                <span class="position only-desktop">Undergraduate Researcher</span>
                <span class="position only-mobile">Undergrad Researcher</span>
                <span class="date-range">
                  <time datetime="2017-08">Aug 2017</time> – <time datetime="2018-05">May 2018</time>
                </span>
              </p>

              <p class="entry">
                <strong class="organization">
                  <span>CommScope</span>
                </strong>
                <span class="location only-desktop">Shakopee, Minnesota</span>
                <span class="location only-mobile">Shakopee, MN</span>
                <span class="position only-desktop">Undergraduate Engineer Intern</span>
                <span class="position only-mobile">Undergraduate Intern</span>
                <span class="date-range">
                  <time datetime="2017-05">May</time> – <time datetime="2017-08">Aug 2017</time>
                </span>
              </p>

            </section>

            <section>
              <h3>Proficiencies</h3>
              <p class="entry">
                <span class="organization">Coding languages</span>
                <span class="position">
                  Matlab,
                  Python,
                  Maple,
                  Visual Basic,
                  JavaScript,
                  HTML,
                  CSS
                </span>
              </p>
              <p class="entry">
                <span class="organization">Machine learning, inference, and optimization</span>
                <span class="position">
                  Gaussian processes,
                  convolutional neural networks,
                  fitting physics-based models to observed data to perform inference
                </span>
              </p>

              <p class="entry">
                <span class="organization">Finite element analysis (code written by me)</span>
                <span class="position">
                  <a href="https://github.com/aco8ogren/2D-dispersion">2D-dispersion</a>,
                  <a href="https://github.com/aco8ogren/3D-dispersion-matlab">3D-dispersion</a>,
                  <a href="https://github.com/aco8ogren/tissue-dispersion">tissue-dispersion</a>
                </span>
              </p>

              <p class="entry">
                <span class="organization">Finite element analysis (commercial software)</span>
                <span class="position">
                  COMSOL Multiphysics,
                  NX Nastran,
                  Abaqus,
                  ANSYS
                </span>
              </p>

              <p class="entry">
                <span class="organization">3D modeling</span>
                <span class="position">
                  Solidworks,
                  Siemens NX,
                  Autodesk AutoCAD
                </span>
              </p>

              <p class="entry">
                <span class="organization">Git</span>
              </p>

              <p class="entry">
                <span class="organization">Spanish</span>
              </p>
            </section>

            <section>
              <h3>Publications</h3>

              <details class="filters" id="filters">
                <summary class="summary">
                  <span>filters</span>
                  <button id="pub-clear" type="button" class="keyword clear-filters" aria-label="Clear all filters">
                    clear all filters
                  </button>
                </summary>

                <div class="filters-panel">
                  <div class="filter-container">

                    <!-- Controls -->
                    <div class="nav-row" style="gap:.5rem; align-items:center">
                      <input id="pub-search" type="search" placeholder="Search title, authors, journal…"
                        style="min-width:18ch;flex:1 1 280px">
                      <select id="pub-sort">
                        <option value="default">default</option>
                        <option value="date-desc">date</option>
                        <option value="title-asc">title</option>
                      </select>
                      <label style="display:inline-flex;gap:.4rem;align-items:center">
                        <input type="checkbox" id="pub-rev"> reverse
                      </label>
                    </div>
                    <!-- keywords -->
                    <div class="kw-sec-label">keywords</div>
                    <div class="nav-row pub-keyword-bar" id="pub-kwbar"></div>

                    <div class="kw-ops" id="kw-ops">
                      <div class="kw-sec-label">keyword operator</div>
                      <div class="ops-group" role="group" aria-label="keyword operator">
                        <button type="button" class="keyword op-toggle" id="kw-op-and" aria-pressed="false">and</button>
                        <button type="button" class="keyword op-toggle" id="kw-op-or" aria-pressed="true">or</button>
                      </div>
                    </div>
                  </div>
                </div>
              </details>



              <div class="kw-summary" id="kw-summary"></div>



              <!-- Target for publication cards -->
              <section class="pubs" id="publications-list" data-persist-open></section>

              <!-- Publication card template -->
              <template id="pub-card-tpl">
                <article class="pub-card">
                  <div class="pub-row-1">
                    <span class="pub-simple-title"></span>
                  </div>
                  <div class="pub-row-2">
                    <a class="pub-thumbnail" href="#" aria-label="">
                      <img src="" alt="">
                      <object data="" type="image/svg+xml" hidden></object>
                    </a>
                    <h5 class="pub-full-title"><a href="#"></a></h5>
                    <span class="pub-journal pub-journal-full only-desktop"></span>
                    <span class="pub-journal pub-journal-short only-mobile"></span>
                    <div class="pub-keywords" hidden></div>
                    <p class="pub-authors"></p>
                  </div>
                </article>
              </template>
            </section>
          </div>
        </div>
      </div>
    </section>

    <!-- ========== PAGE 3 ========== -->
    <section class="page" id="page-3">
      <div class="page-shell">
        <header class="header">
          <div class="center-horizontally">
            <h1>Falling leaves</h1>
            <nav class="nav-row">
              <!-- last page -->
              <a href="#page-2" class="nav-link prev">← prev</a>
            </nav>
          </div>
        </header>

        <div class="page-body scroller edge-fade-x" id="pbs3" data-camera-scroll-source>
          <h2>
            These leaves follow real aerodynamics, simulated in real time
          </h2>
          <p>The falling leaves in the background are a physics-based simulation that I built as a fun way to introduce
            myself
            to JavaScript.
            Falling leaves are visually simple and elegant, yet represent an intricate mathematical dance happening in
            the background.
            Here, you can take a peek behind the curtain to see how I modeled this
            beautiful natural process.
          </p>
          <!-- <div class="nav-row">
            <div class="nav-link">leaf landscape (pure ambience)</div>
            <div class="nav-link">leaf lab (engaging and informative)</div>
          </div> -->

          <h2>
            Setting the scene
          </h2>
          <p>
            In this simulation, each individual leaf is reacting to wind and gravity.
            By considering how the air flows past a leaf, we can determine how the leaf will
            drift and tumble.
          </p>

          <p>
            On this page you can find more technical and mathematical explanations of each facet in the drop-down
            panels, like you see below.
          </p>

          <details class="filters mj">
            <summary class="summary"><span>show the details</span></summary>
            <div class="filters-panel">
              <div class="filter-container">
                <p>
                  Each leaf, idealized as a thin disk, responds to wind and gravity.
                  The air's velocity field is a space-time varying sinusoid combined additively with randomly-spawning
                  Gaussian-enveloped vortices (referred to as <em>swirls</em>).
                </p>
                <p>
                  Given the relative velocity between each leaf and the surrounding air, we can compute the forces
                  and moments that act upon each leaf.
                  From there, we can apply Newton's second law and integrate to propagate the state of each leaf over
                  time.
                </p>
                <p>
                  When a leaf wanders too far out of bounds, it fades and despawns, increasing the probability that a
                  new leaf will spawn near the top of the domain.
                </p>
              </div>
            </div>
          </details>

          <details class="filters mj">
            <summary class="summary"><span>symbols, coordinate systems, units, and conventions</span></summary>
            <div class="filters-panel">
              <div class="filter-container">
                <p>
                  Except where stated otherwise, everything runs on the
                  $\left[\text{kg}\cdot\text{m}\cdot\text{s}\right]$ unit system.<br>
                  $\uvec{i}, \uvec{j}, \uvec{k}$ are unit vectors in the $x, y, z$ directions, respectively<br>
                  In website space, $\uvec{i}, \uvec{j}, \uvec{k}$ point right, up, and into the page, respectively<br>
                  Bold symbols such as $\vec{v}$ are vectors in $\mathbb{R}^3$<br>
                  Hatted symbols such as $\uvec{v}$ are unit vectors<br>
                  $t$ is time<br>
                  $\vec{x} = [x,y,z]$ denotes spatial coordinates<br>
                  $\omega$ is a frequency in $[1/s]$<br>
                  $\gamma$ is a wavevector (spatial version of frequency) in $[1/m]$<br>
                  $\propto$ means "proportional to" (i.e. I'm omitting a scaling factor)<br>
                  $\rho$ signifies density (could be an area density $\left[\text{kg}/\text{m}^2\right]$ or volumetric
                  density $\left[\text{kg}/\text{m}^3\right]$)
                </p>
              </div>
            </div>
          </details>
          <h2>Kinematics</h2>
          <p class="mj">
            <!-- Kinematics is the study and description of motion — positions, orientations, velocities, and accelerations of points, particles, and rigid bodies as functions of time — without considering the forces or moments that cause that motion. -->
            Kinematics is the study and description of motion — positions, orientations, velocities, and accelerations
            of objects as functions of time.
            To properly describe how a leaf falls through the breeze, we need to simulate both the linear kinematics
            (how the leaf is moving in $x, y, z$) and the rotational kinematics (how the leaf flips, spins, and
            rotates).
          </p>
          <details class="filters mj" id="kinematics-mj">
            <summary class="summary"><span>show the math: kinematics</span></summary>
            <div class="filters-panel">
              <div class="filter-container">
                <p>
                  Linear kinematics are pretty simple in this simulation.
                  Each leaf has a position, velocity, and acceleration: $\vec{x}_{\text{leaf}}$,
                  $\vec{v}_{\text{leaf}}$, and $\vec{a}_{\text{leaf}}.$
                  It's easy to propagate these quantities in time because they live in $\mathbb{R}^3$ — meaning that
                  they compose through addition.
                  My simulation uses symplectic Euler for this.
                </p>
                <p>
                  Rotational kinematics are not as simple to model because rotations do <em>not</em> compose through
                  addition (i.e.
                  $\,\boldsymbol{\theta}_{t+\Delta
                  t}\leftarrow \boldsymbol{\theta}_t+\boldsymbol{\omega}\Delta t\,$ doesn't work).
                  Instead, we need to represent rotations and track orientations with quaternions, which live in
                  $\mathbb{R}\times\mathbb{R}^3$.
                  <!-- More on these in the <em>orientations</em> section. -->
                  It may seem like a lot, but seeing the leaves rotate is so worth it!
                </p>
              </div>
            </div>
          </details>

          <details class="filters mj" id="quaternion-details">
            <summary class="summary"><span>show the math: quaternions</span></summary>
            <div class="filters-panel">
              <div class="filter-container">
                <p>
                  My sim uses quaternions for rotation math.
                </p>
                <p>
                  A quaternion is an ordered pair \(q=(w,\vec{q})\in\mathbb{R}\times\mathbb{R}^3\) with scalar part
                  \(w\) and vector part \(\vec{q}\).
                  We write the quaternion product as \(\otimes\).
                </p>
                $$ (a,\vec{A}) \otimes (b,\vec{B})
                = \Big(ab - \vec{A}\!\cdot\!\vec{B},\;\; a\,\vec{B} + b\,\vec{A} + \vec{A}\times\vec{B}\Big). $$
                <p>
                  A <em>unit quaternion</em> satisfies $q \otimes q^{*} = (\|q\|^{2},\,\vec{0}) = (1,\,\vec{0})$.
                  Unit quaternions parametrize 3D rotations.
                  To rotate a vector $\vec{v}$ by quaternion $\vec{q}$, we embed \(\vec{v}\in\mathbb{R}^3\) as a pure
                  quaternion \((0,\vec{v})\) and sandwich multiply:
                  $$\mathcal{R}_q(\vec{v}) \;=\; \big(q \otimes (0,\vec{v}) \otimes q^{-1}\big)$$
                  where, since the result is a quaternion in $\mathbb{R}\times\mathbb{R}^3$, we take only the vector
                  part as the result of the rotation.
                </p>
              </div>
            </div>
          </details>

          <details class="filters mj" id="quaternion-time-stepping-details">
            <summary class="summary"><span>show the math: time-stepping with quaternions</span></summary>
            <div class="filters-panel">
              <div class="filter-container">
                <p>
                  We express angular acceleration $\alpha$ and angular velocity $\omega$ in the <em>inertial</em> frame
                  (as opposed to the <em>local</em> frame),
                  and our
                  quaternion \(q\) maps local→world.
                </p>

                <p class="mj">
                  We integrate angular velocity by treating it as constant over each small step.
                  The kinematic ODE
                  \[
                  \dot q=\tfrac12\,(0,\boldsymbol{\omega})\otimes q
                  \]
                  has the per-step solution
                  \[
                  q_{n+1}=\underbrace{\exp\!\big(\tfrac12(0,\boldsymbol{\omega}_{n+1})\Delta t\big)}_{\text{unit quaternion with axis }\hat{\boldsymbol{\omega}}_{n+1}\text{, and angle }\|\boldsymbol{\omega}_{n+1}\|\Delta t}\ \otimes\ q_n.
                  \]
                  This update rule can be read more simply as $q\leftarrow dq\otimes q$.
                </p>
              </div>
            </div>
          </details>

          <!-- ========== AERODYNAMICS ========== -->
          <h2>Aerodynamics</h2>
          While kinematics explains <em>how</em> things move, it doesn't explain <em>why</em>.
          Dynamics, including <em>aero</em>dynamics, explains the <em>why</em> — objects move as a result of forces and
          moments applied on them by their environment.
          To describe how the wind will influence the motion of a falling leaf, we need to model the aerodynamics.
          <h3>Wind</h3>
          <p>
            Wind is just air that's moving. But in real life, air movement isn't the same everywhere, and it doesn't
            always move in the same way.
            The wind in this simulation reflects that real-life variation — it's a function of both space and time.
          </p>
          <p class="mj">
            In this sim, the background breeze gently blows the leaves left and right.
            To stir things up, short-lived eddies sporadically appear to swirl the leaves around.
          </p>
          <details class="filters mj" id="wind-mj">
            <summary class="summary"><span>show the math: air velocity</span></summary>
            <div class="filters-panel">
              <div class="filter-container">
                <p>
                  The background field is a space-time varying sinusoid:<br>
                  $$\vec{v}_{\text{background}}(\mathbf{x},t)\propto\sin(2\pi\gamma\,y)\sin(2\pi\omega\,t)\uvec{i}.$$
                </p>
                <p>
                  Each swirl is a Gaussian vortex about the $\uvec{k}$-axis, with on-off behavior modulated by smoothed
                  Heaviside envelopes:
                  $$\vec{v}_{\text{swirl}}(\mathbf{x},t)\propto e^{-\tfrac12(r/R)^2}\operatorname{env}(t)\symuvec{\phi},
                  \quad\symuvec{\phi}=\uvec{k}\times\uvec{r}.$$
                  where
                  $\operatorname{env}(t,t_{0},t_{1}) = \operatorname{H_{s,2}}(t-t_{0})\operatorname{H_{s,2}}(t_{1} - t)$
                  turns the vortex on and off with a smoothed Heaviside function at times $t_{0}$ and $t_{1}$
                  respectively.
                  Here, position vector $\vec{r} = \vec{x}-\vec{x_{\text{swirl}}}$, where $\vec{x_{\text{swirl}}}$ is
                  the center of
                  the swirl.
                  Distance from the swirl center is $r = \norm{\vec{r}}$.
                  Radial size variable $R$ scales the spatial size of the swirl.
                </p>
                <p>
                  The total velocity field is the background field, plus any existing swirls:
                  $$\vec{v}_{\text{air}}(\vec{x},t) = \vec{v}_{\text{background}}(\vec{x},t) +
                  \sum_{\text{swirls}}{\vec{v}_{\text{swirl}}(\vec{x},t)}.$$
                </p>
              </div>
            </div>
          </details>
          <h3>Leaves</h3>
          <p class="mj">
            The <em>relative</em> air velocity dictates how each leaf will move.
            If a leaf is already moving the same way as the surrounding air, it'll just continue to go with the flow —
            no extra effect from the wind.
            If not, the wind will encourage the leaf to change what it's doing, causing it to drift, lift, float, and
            tumble.
          </p>

          <details class="filters mj" id="aero-forces-mj">
            <summary class="summary"><span>show the math: aerodynamic forces and moments</span></summary>
            <div class="filters-panel">
              <div class="filter-container">
                <p>
                  The relative velocity between the air and each leaf is computed as:
                </p>
                $$\vec{v}_{\text{rel}} = \vec{v}_{\text{air}} - \vec{v}_{\text{leaf}}$$
                <p>
                  By idealizing each leaf as a thin disk, we can compute the aerodynamic forces and moments
                  analytically.
                  The aerodynamic force is computed as:
                </p>
                $$\vec{F}_{\text{aero}}
                = -\frac{1}{2}\,\rho_{\text{air}}\,A_{\text{leaf}}\,\norm{\vec{v}_{\text{rel}}}^2\!\left[
                \vec{F}_{\text{drag}}
                +
                \vec{F}_{\text{normal}}
                \right].$$
                $$\vec{F}_{\text{drag}} = C_D(\theta)\,\uvec{v}_{\text{rel}}$$
                $$\vec{F}_{\text{normal}} =
                C_N(\theta)\,\operatorname{sgn}\!\big(\uvec{n}_{\text{leaf}}\!\cdot\!\uvec{v}_{\text{rel}}\big)\,\uvec{n}_{\text{leaf}}$$
                <p>The coefficients of drag depend on the angle $\theta$ between the relative velocity
                  $(\uvec{v}_{\text{rel}})$ and the leaf normal $(\uvec{n}_{\text{leaf}})$:</p>
                $$C_D(\theta)=C_{d,\parallel}+\big(C_{d,\perp}-C_{d,\parallel}\big)\cos^2\!\theta$$
                $$C_N(\theta)=C_{N,\max}\sin(2\theta).$$
                <p>We offset the center of pressure a small fraction of the radius along the in-plane flow direction,
                  then compute the moment by a lever-arm $\times$ force cross-product.
                  $$\vec{r} = -a_{\mathrm{CoP}}R\uvec{v}_{\text{rel},\parallel}$$
                </p>
                $$\vec{M}_{\text{aero}} = \mathbf{r}\times \mathbf{F}_{\mathrm{aero}}$$
              </div>
            </div>
          </details>

          <!-- ========== SPACE–TIME DOMAIN ========== -->
          <h2>Space &amp; time</h2>
          <p class="mj">
            The simulation takes place in a finite 3D box of space, but runs in time for as long as the page is open.
          </p>

          <!-- <details class="filters mj" id="space-time-mj">
            <summary class="summary"><span>show the math: the spatiotemporal domain</span></summary>
            <div class="filters-panel">
              <div class="filter-container">
                <p>
                  $$\vec{x}\in [0,L_x]\times[0,L_y]\times[0,L_z]$$
                </p>
                <p>
                  $$t\in[0,\infty)$$
                </p>
              </div>
            </div>
          </details> -->

          <!-- ========== SUBSECTION 1: CAMERA WITHIN THE DOMAIN ========== -->
          <h3>How the camera moves</h3>
          <p class="mj">
            As you scroll, the camera gravitates toward a new target position — but it doesn't go there immediately.
            To make camera movements smooth, we use frame-rate-independent exponentially-damped movement.
          </p>

          <details class="filters mj" id="camera-scroll-mj2">
            <summary class="summary"><span>show the math: smoothing the camera movement</span></summary>
            <div class="filters-panel">
              <div class="filter-container">
                <p>
                  Let $\vec{x}_\star$ denote the camera's current target position (computed directly from scroll
                  location).
                  To move the camera to that location smoothly, we apply
                  $$\vec{x}_{t+\Delta t} = \vec{x}_\star + (\vec{x}_{t} - \vec{x}_\star)e^{-\tau\Delta t}$$
                  where damping rate $\tau > 0$ controls how snappy/laggy the transition feels.
                </p>
              </div>
            </div>
          </details>

          <!-- ========== SUBSECTION 2: SPAWN & CULL ========== -->
          <h2>Creating new leaves</h2>
          <p class="mj">
            When a leaf goes too far out-of-bounds, it fades and disappears.
            Without creating new leaves, all the leaves would eventually fall out of view, leaving an empty scene.
            But if I create new leaves too quickly, we may end up with way too many leaves, and it can look a bit
            overwhelming.
            We use a self-balancing method to keep the vibe going that adjusts how quickly new leaves are created based
            on how many currently exist.
          </p>

          <details class="filters mj" id="spawn-cull-mj2">
            <summary class="summary"><span>show the math: population logic</span></summary>
            <div class="filters-panel">
              <div class="filter-container">
                <p>
                  Initially, the scene is seeded with $N_{0}$ leaves.
                  Over time, aerodynamics or gravity eventually cause them to leave the simulated domain and are culled.
                </p>
                <p>
                  New leaves are probabilistically spawned via a Poisson distribution.
                  <!-- A Poisson distribution models how likely it is for an integer number of events to happen within a given time window, assuming events occur independently at a given average rate. -->
                  The number of leaves that will spawn during a given time-step is drawn as:
                  $$N_{\text{new}} \sim \operatorname{Poisson}(\lambda \Delta t)$$
                  $$\lambda = \lambda_0 \operatorname{max}(0,N_{\text{max}} - N)/N_{\text{max}}$$
                  By this construction, the spawn rate $\lambda$ linearly interpolates between $0$ and the base spawn
                  rate $\lambda_{0}$ based on the current population $N$ and the maximum population $N_{\text{max}}$.
                  If $N \geq N_{\text{max}}$, then $\lambda = 0$ (no new leaves will spawn).
                  If $N = 0$, then $\lambda = \lambda_{0}$ (leaves will spawn at the base spawn rate).
                  This spawn logic is frame-rate independent.
                </p>
                <p>
                  Swirls follow the same spawning logic, but are culled differently from leaves.
                  Each swirl has a set time duration, after which it fades out.
                </p>
              </div>
            </div>
          </details>

          <h2>Artwork</h2>
          <h3>Leaf design</h3>
          <p>
            In nature, no two leaves look exactly alike.
            To reflect this in my sim, I layer different types of structured randomness.
            I designed a handful of different leaf geometries and color palettes.
            Each color palette has several colors to choose from, but are designed such that colors from the same palette look reasonable together.
            When a leaf is created, it randomly picks a geometry and a color palette.
            Then, the leaf uses the color palette to randomly color each of the regions in the geometry.
            This gives each leaf a unique yet coordinated look.
          </p>
          <p>
            Of course, two leaves could randomly end up identical.
            In the current configuration, two leaves in 2349810509294 will be exactly the same.
          </p>

          <h3>Lighting, materials, and fog</h3>
          The scene is lit with a weak ambient light, and a stronger directional light.
          Exponential fog dims objects based on distance to enhance the depth effect.

          <!-- ========== PERFORMANCE NOTES ========== -->
          <h2>Performance</h2>
          <p>
            The sim runs on fixed physics time-steps at 120 Hz, but allows rendering skips with a frame-time accumulator
            and
            a cap on substeps.
            That way, even if you open this website on your smart-fridge, you can still enjoy some
            true-to-physics leaves, though possibly at a lower frame rate.
          </p>
        </div>
      </div>
    </section>


  </div>

  <!-- Call the util AFTER the DOM exists; import via inline module -->
  <script type="module">
    import { copyElementNTimes } from './js/util.js';
    copyElementNTimes('repeated-text', 6, 'copies-target-1');
    copyElementNTimes('repeated-text', 3, 'copies-target-2');
    copyElementNTimes('repeated-text', 8, 'copies-target-3');
  </script>

  <script type="module">
    import { persistDevState, devFocus } from './js/dev-persist.js';

    persistDevState({
      scroll: [
        'window',          // keep main window scroll (if you ever scroll the page)
        '#page-strip',     // your horizontal strip
        '.page .scroller', // the vertical scrollers inside each page
      ],
      detailsRoots: ['body'] // look for <details data-persist-open> anywhere
    });

    // Optional: set once in the console to make every reload jump to your target:
    // devFocus.save('[data-dev-focus]');
    // (or just add data-dev-focus to a single element in the area you’re working on)
  </script>


  <script type="module">
    import './js/leaf_sim/leaf_sim.js';
  </script>

  <!-- <script type="module">
    import katex from 'katex';
  </script> -->

  <script type="module">
    import { setupMathJax, typeset } from './js/mathjax-init.js';
    import { attachSmoothDisclosure } from './js/animations.js';

    await setupMathJax();

    const ctrls = [];

    // Typeset
    for (const d of document.querySelectorAll('.mj')) {
      await typeset(d);                 // lay out math so heights are accurate
    }

    // Wire details animation
    for (const d of document.querySelectorAll('details.filters')) {
      const ctl = attachSmoothDisclosure(d);
      if (ctl) { ctl.recalc(); ctrls.push(ctl); }
    }

    // 2) Still wire your main non-math filters panel (if present)
    const filters = document.getElementById('filters');
    if (filters) {
      const ctl = attachSmoothDisclosure(filters);
      if (ctl) { ctl.recalc(); ctrls.push(ctl); }
    }

    // 3) Keep layouts stable on resize
    addEventListener('resize', () => { for (const c of ctrls) c.recalc(); }, { passive: true });
  </script>


  <script>
    // Auto-show scrollbars on scroll/hover; hide after no activity
    (function attachAutoHide() {
      const AUTOHIDE_MS = 1000; // time to hide after last scroll/hover

      function wire(el, timeout = AUTOHIDE_MS) {
        if (!el) return;
        let hideId = 0;

        const show = () => {
          el.classList.add('scrollbars-visible');
          clearTimeout(hideId);
          hideId = setTimeout(() => el.classList.remove('scrollbars-visible'), timeout);
        };

        el.addEventListener('scroll', show, { passive: true });
        el.addEventListener('mouseenter', show);
        el.addEventListener('mouseleave', () => el.classList.remove('scrollbars-visible'));
        el.addEventListener('touchstart', show, { passive: true });
        el.addEventListener('touchend', () => {
          clearTimeout(hideId);
          hideId = setTimeout(() => el.classList.remove('scrollbars-visible'), timeout);
        }, { passive: true });

        // start hidden; reveal briefly so users discover it
        setTimeout(show, 50);
      }

      document.querySelectorAll('.scroller').forEach(el => wire(el));
    })();
  </script>

  <script type="module" src="./js/publications.js"></script>
  <!-- <script src="./js/publications.js" defer></script> -->


  <!-- ECharts debug overlay -->
  <div class="camera-position-plot hud-panel" id="cam-plot"></div>
  <div class="density-plot hud-panel" id="density-plot"></div>
</body>

<!-- SVG sprite sheet (hidden defs) -->
<svg xmlns="http://www.w3.org/2000/svg" style="display:none;">
  <defs>
    <!-- GITHUB (normalized to 24×24; "contain" fit) -->
    <symbol id="icon-github" viewBox="0 0 24 24" fill="currentColor">
      <!-- Original was 98×96. We scale by s = min(24/98, 24/96) = 0.244898
       That makes width = 24 exactly; height = 23.510... so we center
       with a tiny vertical translate of (24-96*s)/2 = 0.244898 -->
      <g transform="translate(0 0.244898) scale(0.244898)">
        <path fill-rule="evenodd" clip-rule="evenodd"
          d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z" />
      </g>
    </symbol>

    <!-- GOOGLE SCHOLAR -->
    <symbol id="icon-google-scholar" viewBox="0 0 24 24">
      <!-- Original was 48×48; scale by 0.5 to fit exactly -->
      <g transform="scale(0.5)">
        <path fill="currentColor" fill-rule="evenodd"
          d="M 24 4 C 12.954 4 4 12.954 4 24 C 4 35.046 12.954 44 24 44 C 35.046 44 44 35.046 44 24 C 44 12.954 35.046 4 24 4 z M 20.710938 11.087891 L 36.236328 11.087891 L 35.095703 12.039062 C 35.111223 12.090072 35.126953 12.140706 35.126953 12.197266 L 35.126953 17.289062 C 35.771239 17.518611 36.236328 18.128543 36.236328 18.851562 L 36.236328 23.841797 C 36.236328 24.761095 35.490456 25.503906 34.572266 25.503906 C 33.654076 25.503906 32.910156 24.761095 32.910156 23.841797 L 32.910156 18.851562 C 32.910156 18.128543 33.373292 17.518611 34.017578 17.289062 L 34.017578 12.9375 L 29.671875 16.558594 C 29.877024 17.289376 29.929688 18.167375 29.929688 19.244141 C 29.929688 23.316115 26.25 23.815577 26.25 25.548828 C 26.25 27.284296 31.134766 28.67024 31.134766 32.962891 C 31.134766 40.136529 22.572266 39.730469 22.572266 39.730469 C 22.572266 39.730469 15.166016 40.005489 15.166016 34.232422 C 15.166016 28.459357 23.567784 28.689453 23.998047 28.689453 C 23.893809 27.367615 23.037109 27.592296 23.037109 26.933594 L 23.037109 25.322266 C 23.037109 25.322266 16.894126 26.022323 16.701172 19.960938 L 10.730469 19.960938 L 20.710938 11.087891 z M 22.693359 14.431641 C 22.468978 14.42887 22.244252 14.456739 22.023438 14.519531 C 20.259137 15.017439 19.375131 17.490852 20.044922 20.054688 C 20.719149 22.610761 22.694683 24.289188 24.458984 23.789062 C 26.225502 23.291154 27.109244 20.814414 26.439453 18.253906 C 25.849504 16.014431 24.264032 14.451032 22.693359 14.431641 z M 23.193359 29.779297 C 20.230309 29.991102 17.946264 31.975344 18.09375 34.210938 C 18.23902 36.452075 20.762669 38.09715 23.724609 37.888672 C 26.689875 37.681303 28.973394 35.699543 28.828125 33.455078 C 28.681747 31.218375 26.159735 29.570819 23.193359 29.779297 z" />
      </g>
    </symbol>


  </defs>
</svg>





</html>